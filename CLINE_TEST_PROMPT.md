# Cline 프롬프트 - 테스트 실행 및 특정 종목 점수 조회

## 📋 현재 상태 분석

프로젝트가 잘 구성되어 있습니다! Phase 1이 완료된 상태입니다.

### ✅ 완료된 기능
- 한투 API 클라이언트 (토큰, 일봉, 현재가, 거래대금 상위)
- 5가지 지표 점수 산출 (CCI값, CCI기울기, MA20기울기, 양봉품질, 상승률)
- TOP 3 선정 및 디스코드 알림
- SQLite DB 저장
- 스케줄러 (12:30 프리뷰, 15:00 메인)

### ⚠️ 추가 필요 작업
1. **특정 종목 점수 조회 기능** - 현재 없음
2. **Learner Service** - 가중치 자동 조정 (30일 데이터 축적 후)
3. **Streamlit 대시보드** - Phase 3

---

## 🚀 Step 1: 오늘의 TOP 3 테스트 실행

아래 프롬프트를 Cline에 입력하세요:

```
장 마감 후인 22:30에 테스트를 하려고 해.
한투 API가 장 마감 후에도 일봉/현재가 조회가 되는지 확인하고,
오늘의 종가매매 TOP 3를 테스트 모드로 실행해줘.

명령어: python main.py --run-test

실행 후 결과를 보여주고, 에러가 있다면 원인을 분석해줘.
```

---

## 🚀 Step 2: 특정 종목 점수 조회 기능 추가

```
특정 종목의 점수를 조회하는 기능을 추가해줘.
scripts/check_stock_score.py 파일로 생성해.

요구사항:
1. 종목코드를 입력받아 해당 종목의 5가지 지표 점수 출력
2. 순위 표시 (전체 종목 중 몇 위인지)
3. 상세 분석 정보 출력 (CCI 원시값, MA20 등)

사용법:
python scripts/check_stock_score.py 006800   # 미래에셋증권
python scripts/check_stock_score.py 005930   # 삼성전자

출력 예시:
=== 미래에셋증권 (006800) 점수 분석 ===
현재가: 8,500원 (+2.5%)
거래대금: 450억원

[점수 상세]
1. CCI 값 점수: 7.5점 (CCI: 165.2)
2. CCI 기울기 점수: 8.0점 (5일 상승세)
3. MA20 기울기 점수: 6.5점 (7일 +1.2%)
4. 양봉 품질 점수: 8.5점 (윗꼬리 15%, MA20 위)
5. 상승률 점수: 9.0점 (당일 +2.5%)

총점: 39.5점 (가중 합계: XX.X점)
전체 순위: 15위 / 120개 종목
```

---

## 🚀 Step 3: 미래에셋증권 점수 확인

```
scripts/check_stock_score.py를 실행해서 미래에셋증권(006800)의 점수를 확인해줘.

python scripts/check_stock_score.py 006800

결과를 보여주고, 종가매매 관점에서 분석해줘.
```

---

## 📋 전체 실행 순서

### 1. 먼저 테스트 실행
```
python main.py --run-test
```

### 2. 결과 확인 후 특정 종목 조회 기능 추가 요청

### 3. 미래에셋증권 점수 확인
```
python scripts/check_stock_score.py 006800
```

---

## ⚠️ 장 마감 후 API 주의사항

한투 API는 장 마감 후에도 조회 가능합니다:
- **일봉 데이터**: 당일 종가 포함 (15:30 이후 확정)
- **현재가**: 당일 종가로 고정
- **거래대금 상위**: 당일 기준으로 조회

다만, 일부 API는 시간대에 따라 응답이 다를 수 있으므로 에러 발생 시 로그 확인 필요.

---

## 🔧 에러 발생 시 체크리스트

1. **토큰 발급 실패**
   - .env 파일의 KIS_APP_KEY, KIS_APP_SECRET 확인
   - 한투 API 계정 상태 확인

2. **거래대금 조회 실패**
   - API 엔드포인트 변경 여부 확인
   - tr_id 코드 확인 (FHPST01710000)

3. **종목 데이터 없음**
   - 장 휴장일 여부 확인
   - 종목코드 유효성 확인

---

## 💡 추가 유용한 명령어

```bash
# 스케줄러 모드 (12:30, 15:00 자동)
python main.py

# 즉시 실행 (알림 발송)
python main.py --run

# 테스트 실행 (알림/저장 없음)
python main.py --run-test

# 알림 없이 실행 (DB 저장만)
python main.py --run --no-alert

# DB 초기화
python main.py --init-db
```
