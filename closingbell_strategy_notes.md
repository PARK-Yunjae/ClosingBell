# ClosingBell 종가매매 전략 분석 및 개선 노트 v3.0

> 작성일: 2026-01-08  
> 목적: v3.0 전략 파라미터 확정 및 향후 개선 방향

---

## 1. v3.0 확정 전략 (Current Strategy)

### 1.1 종목 선정 기준 (진입)

| 지표 | 조건 | 파라미터 | 점수 로직 |
|------|------|----------|-----------|
| **거래대금** | 300억 이상 | 300억 | 필수 필터 (점수화 X) |
| **CCI(14)** | 180 근접 | 180 ± 20 | 180에 가까울수록 최고점 |
| **CCI 기울기** | 상승세 | 2일 | 최근 2일 연속 상승 시 만점 |
| **MA20 기울기** | 우상향 | 3일 | 최근 3일 연속 상승 시 만점 |
| **양봉 품질** | 윗꼬리 짧음 | < 10% | 윗꼬리 비율 낮을수록 가점 |
| **MA20 위치** | 안착 | 0~2% | MA20 바로 위에 있을 때 최고점 |
| **등락률** | - | - | **비활성화** (가중치 0) |

### 1.2 매도 전략 (청산)

**현재 사용 중:**
```
절반(50%): 익일 시초가 매도
절반(50%): 트레일링 스탑 (-3% 손절 / +3% 익절)
```

**v3.0 변경사항:**
- 등락률 점수 비활성화 (백테스트 결과 역상관 관계 확인)
- CCI 기울기 기간 단축 (5일 → 2일): 단기 모멘텀 반영 강화
- MA20 기울기 기간 단축 (7일 → 3일): 추세 변화 민감도 향상

---

## 2. 전략 평가

### 2.1 잘하고 있는 점 ✅

**1) 단순함 유지**
- 복잡한 지표 추가 시 성과 악화 경험
- 핵심 지표(CCI, MA20, 캔들)만 사용하는 것이 정답
- 과적합(overfitting) 위험 회피

**2) 매도 전략 체계화**
- 종가매매에서 매도 전략이 수익의 70% 결정
- 분할 매도로 리스크 분산

**3) 논리적 일관성**
- CCI: 모멘텀 확인
- MA20: 추세 확인  
- 양봉/윗꼬리: 수급 확인

### 2.2 주의해야 할 점 ⚠️

**1) CCI 180 고정값의 한계**
```
시장 상황별로 최적 CCI가 다름:
- 강세장: 150~200도 OK
- 약세장: 100~150이 더 안전
- 횡보장: CCI 자체가 무의미할 수 있음
```

**2) 과거 실패 원인 분석**
```
외인 수급 추가 실패 이유:
→ 데이터 지연 (장 마감 후 확정, 종가매매에 늦음)

뉴스 분석 추가 실패 이유:
→ 이미 가격에 반영됨 (효율적 시장 가설)

회전율/거래량 추가 실패 이유:
→ 거래대금과 중복되는 정보 (노이즈만 추가)
```

---

## 3. 향후 개선 아이디어

### 3.1 시장 상황 필터 (간단한 것 하나만)

```python
# 코스닥 지수가 MA20 위/아래로 시장 상황 판단
def get_market_regime():
    if kosdaq_close >= kosdaq_ma20:
        return 'BULL'  # 상승장
    else:
        return 'BEAR'  # 하락장
```

### 3.2 CCI 범위 유동화

```python
# 고정값 대신 범위 사용
CCI_OPTIMAL_RANGE = (120, 250)  # v3.0에서 범위 확장 고려

# 또는 시장 상황별 차등
if market == 'BULL':
    CCI_RANGE = (160, 220)  # 공격적
else:
    CCI_RANGE = (120, 180)  # 보수적
```

### 3.3 손익비 개선 아이디어

```python
# 현재: -3% / +3% (손익비 1:1)
# 개선안: 승률에 따라 조정

# 승률 60% 이상이면 손익비 낮춰도 됨
stop_loss = -2%
take_profit = +4%  # 손익비 1:2
```

---

## 4. 하지 말아야 할 것들 🚫

### 4.1 지표 과다 추가
```
❌ 외인/기관 수급 (데이터 지연)
❌ 뉴스 감성 분석 (이미 반영됨)
❌ 섹터 로테이션 (너무 복잡)
❌ RSI, MACD, 볼린저 등 중복 지표
```

### 4.2 과최적화
```
❌ 백테스트에서 완벽한 파라미터 찾기
❌ 특정 기간에만 맞는 전략
❌ 너무 많은 조건 조합
```

---

## 5. 백테스트 결과 해석 가이드

### 5.1 상관관계 해석

```
양의 상관관계 (+0.03 이상):
→ 해당 점수가 높을수록 익일 수익률 높음
→ 가중치 올리기

음의 상관관계 (-0.03 이하):
→ 해당 점수가 높을수록 오히려 수익률 낮음
→ 가중치 낮추거나 제거 고려

무상관 (-0.03 ~ +0.03):
→ 예측력 없음
→ 기본 가중치(1.0) 유지
```

### 5.2 가중치 적용 기준 (v3.0)

```python
# 상관관계 기반 가중치 (v3.0 기본값)
DefaultWeights = {
    'cci_value': 1.0,
    'cci_slope': 2.5,   # 중요도 상향
    'ma20_slope': 2.5,  # 중요도 상향
    'candle': 2.5,      # 중요도 상향
    'change': 0.0,      # 비활성화
}
```

---

## 6. 실전 적용 체크리스트

### 6.1 모니터링

- [ ] 1주일 후 실제 승률 확인
- [ ] 2주일 후 평균 수익률 확인
- [ ] 1개월 후 종합 평가 및 재조정 검토

---

## 7. 핵심 요약

### 현재 전략 점수: ⭐⭐⭐⭐ (4.5/5)

**강점:**
- 단순하고 논리적
- 실전 검증 완료
- 리스크 관리 체계 있음
- 불필요한 지표(등락률) 제거로 정확도 향상

### 최종 조언

> "더 추가하면 오히려 망할 확률이 높다"

v3.0 설정은 이미 충분히 최적화되었습니다.  
이제는 전략의 일관된 실행이 더 중요합니다.

---
