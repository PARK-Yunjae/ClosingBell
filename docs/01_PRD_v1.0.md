# 1. PRD (Product Requirements Document) v3.0

**프로젝트명:** 종가매매 스크리너 (Closing Trade Screener)  
**버전:** 3.0  
**작성일:** 2026-01-08  
**상태:** Active  

---

## 1.1 개요

### 1.1.1 결론
한국투자증권 API를 활용하여 매일 장 마감 전 종가매매 후보 종목 TOP 3를 자동으로 선별하고, 디스코드 알림을 발송하며, 익일 결과를 추적하여 점수 가중치를 동적으로 최적화하는 시스템을 개발한다.

### 1.1.2 근거
- 수동으로 300억+ 거래대금 종목을 매일 스크리닝하는 것은 시간 소모가 큼
- 5가지 기술적 지표 조합의 백테스팅 및 가중치 최적화 필요
- 기존 Hantubot과 별개로 종가매매 전용 시스템 필요

### 1.1.3 리스크/대안
| 리스크 | 대안 |
|--------|------|
| 한투 API 호출 한도 초과 | 캐싱 + 필수 종목만 조회 |
| 실시간 데이터 지연 | 15:00 기준 충분한 버퍼 시간 확보 (15:03~15:18) |
| 점수 최적화 과적합 | 최소 30일 이상 데이터 수집 후 조정 |

---

## 1.2 목표 (Goals)

| ID | 목표 | 측정 방법 |
|----|------|----------|
| G1 | 매일 15:00에 종가매매 후보 TOP 3 자동 선별 | 알림 발송 성공률 |
| G2 | 12:30 프리뷰 알림 제공 (저장 없음) | 알림 발송 여부 |
| G3 | 익일 결과 기반 점수 가중치 자동 조정 | 가중치 변경 로그 |
| G4 | 수동 매매 일지 기록 및 통합 분석 | 일지 입력 건수 |
| G5 | Streamlit 대시보드로 전체 데이터 시각화 | 대시보드 접근 가능 |

---

## 1.3 범위 (In Scope)

### 1.3.1 핵심 기능
| ID | 기능 | 우선순위 |
|----|------|----------|
| F1 | 거래대금 300억 이상 종목 필터링 | P0 (필수) |
| F2 | 5가지 기술 지표 점수 산출 | P0 (필수) |
| F3 | 상대평가 TOP 3 선정 | P0 (필수) |
| F4 | 디스코드 웹훅 알림 | P0 (필수) |
| F5 | 15:00 스크리닝 결과 DB 저장 | P0 (필수) |
| F6 | 12:30 프리뷰 알림 (저장 없음) | P1 (중요) |
| F7 | 익일 결과 수집 및 점수 가중치 조정 | P1 (중요) |
| F8 | 수동 매매일지 입력/관리 | P2 (선택) |
| F9 | Streamlit 대시보드 | P2 (선택) |

### 1.3.2 기술 지표 상세 (5가지 조건)

| # | 지표 | 조건 | 점수 로직 |
|---|------|------|----------|
| 1 | CCI(14일) | 180 근접 여부 | 180 근접 시 높은 점수, 200~400에서 하락 시 감점 |
| 2 | CCI 기울기 | 상승세 여부 | 최근 2일 기울기 양수 = 가점 |
| 3 | MA(20일) 기울기 | 상승세 여부 | 최근 3일 기울기 양수 = 가점 |
| 4 | 양봉 품질 | 윗꼬리 비율 + MA 위치 | 조건 충족 시 가점, 위반 시 감점 |
| 5 | 당일 상승률 | 5~20% 적정 상승 | 5~20% 구간 최고 가점, 5% 미만 또는 20% 초과 시 감점 |

---

## 1.4 비범위 (Out of Scope)

| ID | 제외 항목 | 제외 사유 |
|----|----------|----------|
| X1 | 자동 매매 실행 | 본 시스템은 스크리닝/알림 전용 |
| X2 | 해외 주식 | 국내 증시 종가매매 전용 |
| X3 | 분봉/틱 데이터 분석 | 일봉 기준으로 결정됨 |
| X4 | 실시간 호가창 분석 | 기술적 지표 기반 분석만 |
| X5 | 다중 사용자 지원 | 개인용 단일 사용자 시스템 |
| X6 | 12:30 데이터 저장 | 결정사항 D4에 따름 |

---

## 1.5 성공 지표 (Success Metrics)

### 1.5.1 정량 지표

| 지표 | 목표치 | 측정 주기 |
|------|--------|----------|
| 알림 발송 성공률 | ≥ 99% | 일간 |
| 스크리닝 완료 시간 | ≤ 5분 (15:00 ~ 15:05) | 일간 |
| TOP 3 익일 시초가 상승 적중률 | ≥ 60% | 주간 |
| 시스템 가동률 | ≥ 95% | 월간 |
| 가중치 최적화 후 적중률 개선 | +10%p | 월간 |

### 1.5.2 정성 지표

| 지표 | 목표 |
|------|------|
| 매매 의사결정 시간 단축 | 수동 스크리닝 대비 90% 감소 |
| 데이터 기반 전략 개선 | 월 1회 이상 인사이트 도출 |

---

## 1.6 가정 및 의존성

### 1.6.1 가정 (Assumptions)
| ID | 가정 |
|----|------|
| A1 | 한투 API 일봉 데이터는 장 중에도 당일 데이터 포함 |
| A2 | 거래대금 300억 필터링 시 약 50~150개 종목 예상 |
| A3 | 평일 장 운영일에만 실행 (공휴일/주말 제외) |

### 1.6.2 의존성 (Dependencies)
| ID | 의존성 | 상태 |
|----|--------|------|
| DEP1 | 한국투자증권 API 키 | ✅ 보유 |
| DEP2 | 디스코드 웹훅 URL | ✅ 보유 |
| DEP3 | Gemini API 키 | ✅ 보유 (추후 AI 분석용) |

> **참고:** 뉴스 수집은 제외합니다. 모든 정보(기대감, 내부자 매매 등)는 결국 차트에 반영된다는 철학에 기반합니다.

---

## 1.7 타임라인 (Milestone)

| Phase | 내용 | 예상 기간 |
|-------|------|----------|
| Phase 1 | 핵심 기능 (F1~F5) | 완료 |
| Phase 2 | 12:30 알림 + 익일 추적 (F6~F7) | 완료 |
| Phase 3 | 매매일지 + 대시보드 (F8~F9) | 완료 |
| Phase 4 | 카카오톡 연동 | 취소 |

---

## 1.8 문서 이력

| 버전 | 날짜 | 변경 내용 | 작성자 |
|------|------|----------|--------|
| 1.0 | 2025-01-06 | 초안 작성 | Architect AI |
| 3.0 | 2026-01-08 | Kakao 제거, 지표 기간 조정 | Refactoring AI |

---

**다음 문서:** [02_User_Stories.md](./02_User_Stories.md)
