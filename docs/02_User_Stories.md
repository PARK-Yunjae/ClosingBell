# 2. 유저 스토리 및 수용 기준 (User Stories & Acceptance Criteria)

**프로젝트명:** 종가매매 스크리너  
**버전:** 1.0  
**작성일:** 2025-01-06  

---

## 2.1 개요

### 2.1.1 결론
15개의 유저 스토리를 우선순위별로 정의하고, 각 스토리에 대한 명확한 수용 기준을 설정하여 개발 완료 판단 기준을 명확히 한다.

### 2.1.2 근거
- 기능 단위 개발 및 테스트 가능
- 우선순위 기반 점진적 개발 지원
- QA 체크리스트로 활용 가능

### 2.1.3 리스크/대안
| 리스크 | 대안 |
|--------|------|
| 스토리 간 의존성 복잡 | 의존성 명시 및 순차 개발 |
| AC 모호성 | Given-When-Then 형식 준수 |

---

## 2.2 유저 스토리 목록

### Epic 1: 종목 스크리닝 (P0)

---

#### US-01: 거래대금 필터링
**As a** 트레이더  
**I want** 당일 거래대금 300억 이상 종목만 필터링되기를  
**So that** 유동성 있는 종목만 분석 대상으로 삼을 수 있다

**Priority:** P0  
**Story Points:** 3  
**Dependencies:** 없음

**Acceptance Criteria:**
| ID | Given | When | Then |
|----|-------|------|------|
| AC-01-1 | 장 운영 중 (09:00~15:30) | 스크리닝 실행 시 | 거래대금 300억 미만 종목은 제외된다 |
| AC-01-2 | 거래대금 정확히 300억인 종목 | 스크리닝 실행 시 | 해당 종목은 포함된다 (≥ 조건) |
| AC-01-3 | ETF, ETN, 스팩 종목 | 스크리닝 실행 시 | 해당 종목은 제외된다 |
| AC-01-4 | 관리종목, 거래정지 종목 | 스크리닝 실행 시 | 해당 종목은 제외된다 |

---

#### US-02: CCI(14일) 점수 산출
**As a** 트레이더  
**I want** 각 종목의 CCI(14일) 값을 기반으로 점수가 산출되기를  
**So that** 과매수 진입 전 최적 타이밍 종목을 찾을 수 있다

**Priority:** P0  
**Story Points:** 5  
**Dependencies:** US-01

**Acceptance Criteria:**
| ID | Given | When | Then |
|----|-------|------|------|
| AC-02-1 | CCI 값이 175~185 사이 | 점수 산출 시 | 최고 점수 부여 (180 정중앙) |
| AC-02-2 | CCI 값이 160~190 사이 | 점수 산출 시 | 높은 점수 (180 근접) |
| AC-02-3 | CCI 값이 140~200 사이 | 점수 산출 시 | 중간 점수 |
| AC-02-4 | CCI 값이 100~140 또는 200~250 | 점수 산출 시 | 낮은 점수 (180에서 멀어짐) |
| AC-02-5 | CCI 값이 100 미만 또는 250 초과 | 점수 산출 시 | 감점 (과매도/과매수 극단) |
| AC-02-6 | CCI 계산에 필요한 14일 데이터 부족 | 점수 산출 시 | 해당 종목 제외 또는 0점 처리 |

---

#### US-03: CCI 기울기 분석
**As a** 트레이더  
**I want** CCI의 최근 기울기(상승/하락)를 분석하기를  
**So that** 상승 추세 종목만 선별할 수 있다

**Priority:** P0  
**Story Points:** 3  
**Dependencies:** US-02

**Acceptance Criteria:**
| ID | Given | When | Then |
|----|-------|------|------|
| AC-03-1 | 최근 5일 CCI 값이 연속 상승 | 기울기 분석 시 | 최고 가점 부여 |
| AC-03-2 | 최근 5일 CCI 값이 상승 추세 (일부 조정 포함) | 기울기 분석 시 | 높은 가점 부여 |
| AC-03-3 | 최근 5일 CCI 값이 횡보 | 기울기 분석 시 | 중립 점수 |
| AC-03-4 | 최근 5일 CCI 값이 하락 추세 | 기울기 분석 시 | 감점 부여 |
| AC-03-5 | CCI 200 이상에서 하락 중 | 기울기 분석 시 | 추가 감점 (고점 하락 경고) |

---

#### US-04: 이동평균선(20일) 기울기 분석
**As a** 트레이더  
**I want** 20일 이동평균선의 기울기를 분석하기를  
**So that** 중기 상승 추세 종목을 찾을 수 있다

**Priority:** P0  
**Story Points:** 3  
**Dependencies:** US-01

**Acceptance Criteria:**
| ID | Given | When | Then |
|----|-------|------|------|
| AC-04-1 | MA20 최근 7일 연속 상승 | 기울기 분석 시 | 최고 가점 |
| AC-04-2 | MA20 최근 7일 상승 추세 (일부 조정 포함) | 기울기 분석 시 | 높은 가점 |
| AC-04-3 | MA20 횡보 (±0.5% 이내) | 기울기 분석 시 | 중립 점수 |
| AC-04-4 | MA20 하락 추세 | 기울기 분석 시 | 감점 |
| AC-04-5 | MA20 급락 (7일 -3% 이상) | 기울기 분석 시 | 강한 감점 |

---

#### US-05: 양봉 품질 평가
**As a** 트레이더  
**I want** 당일 캔들이 양봉인지, 그리고 양봉의 품질을 평가하기를  
**So that** 매수세가 강한 종목을 찾을 수 있다

**Priority:** P0  
**Story Points:** 5  
**Dependencies:** US-01

**Acceptance Criteria:**
| ID | Given | When | Then |
|----|-------|------|------|
| AC-05-1 | 양봉이고 윗꼬리 < 몸통의 30% | 품질 평가 시 | 높은 점수 |
| AC-05-2 | 양봉이고 종가가 MA20 위에 안착 | 품질 평가 시 | 가점 |
| AC-05-3 | 양봉이지만 종가가 MA20보다 많이 위 (>5%) | 품질 평가 시 | 감점 (과열) |
| AC-05-4 | 양봉이지만 종가가 MA20 아래 | 품질 평가 시 | 감점 (미안착) |
| AC-05-5 | 음봉인 경우 | 품질 평가 시 | 0점 또는 감점 |

---

#### US-06: 당일 상승률 평가
**As a** 트레이더  
**I want** 당일 상승률이 적정 범위(5~20%)인 종목을 평가하기를  
**So that** 적절한 모멘텀 종목을 포착할 수 있다

**Priority:** P0  
**Story Points:** 2  
**Dependencies:** US-01

**Acceptance Criteria:**
| ID | Given | When | Then |
|----|-------|------|------|
| AC-06-1 | 당일 상승률 10~15% | 평가 시 | 최고 가점 (최적 구간) |
| AC-06-2 | 당일 상승률 5~10% 또는 15~20% | 평가 시 | 높은 가점 |
| AC-06-3 | 당일 상승률 3~5% | 평가 시 | 중간 점수 |
| AC-06-4 | 당일 상승률 20% 초과 | 평가 시 | 감점 (과열, 추격 위험) |
| AC-06-5 | 당일 상승률 3% 미만 | 평가 시 | 감점 (모멘텀 부족) |
| AC-06-6 | 당일 하락 | 평가 시 | 강한 감점 |

---

#### US-07: TOP 3 종목 선정
**As a** 트레이더  
**I want** 5가지 지표의 종합 점수로 TOP 3 종목이 선정되기를  
**So that** 가장 유망한 종목에 집중할 수 있다

**Priority:** P0  
**Story Points:** 3  
**Dependencies:** US-02, US-03, US-04, US-05, US-06

**Acceptance Criteria:**
| ID | Given | When | Then |
|----|-------|------|------|
| AC-07-1 | 50개 이상 종목이 필터링됨 | TOP 3 선정 시 | 점수 상위 3개 반환 |
| AC-07-2 | 동점 종목 존재 | TOP 3 선정 시 | 거래대금 높은 순으로 결정 |
| AC-07-3 | 필터링 종목이 3개 미만 | TOP 3 선정 시 | 있는 만큼만 반환 + 알림에 표시 |
| AC-07-4 | 모든 종목 0점 | TOP 3 선정 시 | "적합 종목 없음" 알림 |

---

### Epic 2: 알림 발송 (P0/P1)

---

#### US-08: 디스코드 웹훅 알림 (15:00)
**As a** 트레이더  
**I want** 15:00 스크리닝 결과를 디스코드로 받기를  
**So that** 종가매매 전 빠르게 확인할 수 있다

**Priority:** P0  
**Story Points:** 3  
**Dependencies:** US-07

**Acceptance Criteria:**
| ID | Given | When | Then |
|----|-------|------|------|
| AC-08-1 | TOP 3 선정 완료 | 알림 발송 시 | 종목코드, 종목명, 점수, 현재가, 상승률 포함 |
| AC-08-2 | 웹훅 URL 유효 | 알림 발송 시 | 200 응답 수신 |
| AC-08-3 | 웹훅 URL 오류 | 알림 발송 시 | 에러 로깅 + 재시도 1회 |
| AC-08-4 | 발송 시각 | 알림 발송 시 | 15:03~15:10 사이 완료 |

---

#### US-09: 디스코드 웹훅 알림 (12:30 프리뷰)
**As a** 트레이더  
**I want** 12:30에 중간 프리뷰 알림을 받기를  
**So that** 오후 흐름을 미리 파악할 수 있다

**Priority:** P1  
**Story Points:** 2  
**Dependencies:** US-08

**Acceptance Criteria:**
| ID | Given | When | Then |
|----|-------|------|------|
| AC-09-1 | 12:30 스크리닝 실행 | 알림 발송 시 | "[프리뷰]" 라벨 포함 |
| AC-09-2 | 12:30 결과 | DB 저장 | 저장하지 않음 (메모리만) |
| AC-09-3 | 12:30 알림 실패 | 에러 발생 시 | 15:00 알림에 영향 없음 |

---

#### US-10: 카카오톡 알림 (선택)
**As a** 트레이더  
**I want** 카카오톡으로도 알림을 받기를  
**So that** 디스코드 확인이 어려울 때도 알림을 받을 수 있다

**Priority:** P2  
**Story Points:** 5  
**Dependencies:** US-08, 카카오 비즈니스 채널 설정

**Acceptance Criteria:**
| ID | Given | When | Then |
|----|-------|------|------|
| AC-10-1 | 카카오 채널 연동 완료 | 알림 발송 시 | 카카오톡 메시지 수신 |
| AC-10-2 | 카카오 연동 미완료 | 시스템 시작 시 | 디스코드만 사용 (에러 아님) |

---

### Epic 3: 데이터 저장 및 학습 (P1)

---

#### US-11: 스크리닝 결과 DB 저장
**As a** 트레이더  
**I want** 15:00 스크리닝 전체 결과가 DB에 저장되기를  
**So that** 과거 데이터 분석이 가능하다

**Priority:** P0  
**Story Points:** 3  
**Dependencies:** US-07

**Acceptance Criteria:**
| ID | Given | When | Then |
|----|-------|------|------|
| AC-11-1 | 스크리닝 완료 | 저장 시 | 모든 300억+ 종목 점수 저장 (TOP 3만 아님) |
| AC-11-2 | 동일 날짜 재실행 | 저장 시 | 기존 데이터 덮어쓰기 (upsert) |
| AC-11-3 | DB 저장 실패 | 에러 시 | 로깅 + 알림은 정상 발송 |

---

#### US-12: 익일 결과 추적
**As a** 트레이더  
**I want** 전일 스크리닝 종목의 익일 결과를 수집하기를  
**So that** 점수의 유효성을 검증할 수 있다

**Priority:** P1  
**Story Points:** 5  
**Dependencies:** US-11

**Acceptance Criteria:**
| ID | Given | When | Then |
|----|-------|------|------|
| AC-12-1 | 장 종료 후 (15:30 이후) | 익일 결과 수집 시 | 시초가, 종가, 고가, 저가 저장 |
| AC-12-2 | 전일 데이터 존재 | 결과 수집 시 | 해당 레코드에 결과 업데이트 |
| AC-12-3 | 시초가 상승 여부 | 결과 수집 시 | 상승/하락 플래그 저장 |
| AC-12-4 | 추가 분석 데이터 | 결과 수집 시 | 거래량, 거래대금, 등락률 저장 |
| AC-12-5 | 장중 변동성 | 결과 수집 시 | 고가-저가 변동폭(%) 저장 |
| AC-12-6 | 갭 분석 | 결과 수집 시 | 시초가 갭(전일종가 대비) 저장 |

---

#### US-13: 점수 가중치 동적 조정
**As a** 트레이더  
**I want** 익일 결과를 바탕으로 5가지 지표의 가중치가 자동 조정되기를  
**So that** 시스템이 점점 더 정확해진다

**Priority:** P1  
**Story Points:** 8  
**Dependencies:** US-12

**Acceptance Criteria:**
| ID | Given | When | Then |
|----|-------|------|------|
| AC-13-1 | 30일 이상 데이터 축적 | 가중치 조정 시 | 자동 최적화 실행 |
| AC-13-2 | 특정 지표가 적중률과 상관관계 높음 | 조정 시 | 해당 지표 가중치 증가 |
| AC-13-3 | 가중치 변경 | 조정 시 | 변경 전/후 로깅 |
| AC-13-4 | 가중치 범위 | 조정 시 | 최소 0.5 ~ 최대 5.0 제한 |
| AC-13-5 | 급격한 변화 방지 | 조정 시 | 1회 조정 시 ±0.2 이내 |

---

### Epic 4: 매매일지 및 시각화 (P2)

---

#### US-14: 수동 매매일지 입력
**As a** 트레이더  
**I want** 수동 매매 결과를 기록하기를  
**So that** 자동 스크리닝과 수동 매매 성과를 비교할 수 있다

**Priority:** P2  
**Story Points:** 5  
**Dependencies:** 없음

**Acceptance Criteria:**
| ID | Given | When | Then |
|----|-------|------|------|
| AC-14-1 | 매매일지 입력 | 저장 시 | 종목코드, 매수가, 매도가, 수익률, 보유수량, 메모 저장 |
| AC-14-2 | 스크리닝 종목과 연결 | 입력 시 | 해당 스크리닝 레코드와 연결 (선택) |
| AC-14-3 | 입력 방식 | UI | Streamlit 폼 또는 API |
| AC-14-4 | 보유 현황 | 조회 시 | 현재 보유 중인 종목 및 수량 표시 |

---

#### US-15: Streamlit 대시보드
**As a** 트레이더  
**I want** 전체 데이터를 시각화된 대시보드로 보기를  
**So that** 한눈에 성과와 패턴을 파악할 수 있다

**Priority:** P2  
**Story Points:** 8  
**Dependencies:** US-11, US-12, US-14

**Acceptance Criteria:**
| ID | Given | When | Then |
|----|-------|------|------|
| AC-15-1 | 대시보드 접속 | 로드 시 | 최근 30일 스크리닝 결과 표시 |
| AC-15-2 | TOP 3 적중률 차트 | 표시 시 | 일별 적중률 추이 그래프 |
| AC-15-3 | 지표별 가중치 현황 | 표시 시 | 현재 가중치 + 변경 이력 |
| AC-15-4 | 매매일지 요약 | 표시 시 | 총 수익률, 승률 표시 |
| AC-15-5 | 필터링 | 조작 시 | 날짜, 종목, 점수 범위 필터 |

---

## 2.3 스토리 의존성 맵

```
US-01 (거래대금 필터)
  ├── US-02 (CCI 점수)
  │     └── US-03 (CCI 기울기)
  ├── US-04 (MA 기울기)
  ├── US-05 (양봉 품질)
  └── US-06 (상승률)
        │
        ▼
      US-07 (TOP 3 선정)
        ├── US-08 (디스코드 15:00) ─── US-09 (디스코드 12:30)
        │     └── US-10 (카카오톡)
        └── US-11 (DB 저장)
              └── US-12 (익일 추적)
                    └── US-13 (가중치 조정)

US-14 (매매일지) ──┐
                  ├── US-15 (대시보드)
US-11, US-12 ─────┘
```

---

## 2.4 문서 이력

| 버전 | 날짜 | 변경 내용 | 작성자 |
|------|------|----------|--------|
| 1.0 | 2025-01-06 | 초안 작성 | Architect AI |

---

**이전 문서:** [01_PRD_v1.0.md](./01_PRD_v1.0.md)  
**다음 문서:** [03_User_Flows.md](./03_User_Flows.md)
